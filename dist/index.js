import t from"vanjs-core";function e(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]])}return n}"function"==typeof SuppressedError&&SuppressedError;const n=t.state(""),o=t.state(window.location.pathname),r=t.state({}),a=t.state({}),l=/:([^\\d|^/]([^/]+)?)/;function s(s){var{routes:i,basename:c}=s,p=e(s,["routes","basename"]);const d=t.state(!1),v=t.tags.div(Object.assign({},p)),f=t=>{if(!t)return"";for(t.startsWith("/")||(t="/"+t);"/"!==t&&t.endsWith("/");)t=t.slice(0,t.length-1);return t},u=()=>{const{route:t,params:e}=((t,e)=>{t=f(t),e=f(e);const n=t.split("/"),o={};let r=null;for(const t of i){const a=f(e+t.path).split("/");if(a.length!==n.length)continue;let s=!0;for(let t=0;t<a.length;t++){const e=a[t],r=n[t];if(l.test(e))o[decodeURIComponent(e.slice(1))]=decodeURIComponent(r);else if(r!==e){s=!1;break}}if(s){r=t;break}}return r||(r=i.find((t=>"*"===t.path))||null),{route:r,params:o}})(window.location.pathname,c||"");t&&(v.replaceChildren(t.component()),a.val=(t=>{if(t.startsWith("?")&&(t=t.slice(1).trim()),!t)return{};const e={},n=t.split("&");for(const t of n){const[n,o]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(o)}return e})(window.location.search),r.val=e)};return t.derive((()=>{window.onpopstate=u,u()})),t.derive((()=>{o.val&&(d.val?u():d.val=!0)})),t.derive((()=>{n.val=f(c||"")})),v}function i(r,...a){var{replace:l}=r;const s=e(r,["replace"]),{onclick:i,href:c}=s,p=e(s,["onclick","href"]),d=t.tags.a(Object.assign(Object.assign({},p),{href:c,onclick:t=>{var e;t.preventDefault(),l?window.history.replaceState({},"",n.val+c):window.history.pushState({},"",n.val+c),c&&(o.val=n.val+c),null===(e=null==i?void 0:i.bind(d))||void 0===e||e(t)}}),...a);return d}const c=()=>o.val,p=()=>r.val,d=()=>a.val,v=(t,e)=>{const{replace:r}=e||{};r?window.history.replaceState({},"",n.val+t):window.history.pushState({},"",n.val+t),o.val=n.val+t};export{i as Link,s as Router,p as getRouterParams,c as getRouterPathname,d as getRouterQuery,v as navigate};
