import t from"vanjs-core";function e(t,e){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(o[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(o[n[r]]=t[n[r]])}return o}"function"==typeof SuppressedError&&SuppressedError;const o=t.state(window.location.pathname),n=t.state({}),r=t.state({}),a=/:([^\\d|^/]([^/]+)?)/;function s(s){var{routes:l}=s,i=e(s,["routes"]);const c=t.state(!1),p=t.tags.div(Object.assign({},i)),d=()=>{const{route:t,params:e}=(t=>{for(;"/"!==t&&t.endsWith("/");)t=t.slice(0,t.length-1);const e=t.split("/"),o={};let n=null;for(const t of l){const r=t.path.split("/");if(r.length!==e.length)continue;let s=!0;for(let t=0;t<r.length;t++){const n=r[t],l=e[t];if(a.test(n))o[decodeURIComponent(n.slice(1))]=decodeURIComponent(l);else if(l!==n){s=!1;break}}if(s){n=t;break}}return n||(n=l.find((t=>"*"===t.path))||null),{route:n,params:o}})(window.location.pathname);t&&(p.replaceChildren(t.component()),r.val=(t=>{if(t.startsWith("?")&&(t=t.slice(1).trim()),!t)return{};const e={},o=t.split("&");for(const t of o){const[o,n]=t.split("=");e[decodeURIComponent(o)]=decodeURIComponent(n)}return e})(window.location.search),n.val=e)};return t.derive((()=>{window.onpopstate=d,d()})),t.derive((()=>{o.val&&(c.val?d():c.val=!0)})),p}function l(n,...r){var{replace:a}=n;const s=e(n,["replace"]),{onclick:l,href:i}=s,c=e(s,["onclick","href"]),p=t.tags.a(Object.assign(Object.assign({},c),{href:i,onclick:t=>{var e;t.preventDefault(),a?window.history.replaceState({},"",i):window.history.pushState({},"",i),i&&(o.val=i),null===(e=null==l?void 0:l.bind(p))||void 0===e||e(t)}}),...r);return p}const i=()=>o.val,c=()=>n.val,p=()=>r.val,d=(t,e)=>{const{replace:n}=e||{};n?window.history.replaceState({},"",t):window.history.pushState({},"",t),o.val=t};export{l as Link,s as Router,c as getRouterParams,i as getRouterPathname,p as getRouterQuery,d as navigate};
